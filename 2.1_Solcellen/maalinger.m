% Feilmåling. Brant motstand
%V = [847.22 848.67 856.01 855.00 847.21]*1e-3;
%Vl= [3.9283 3.9284 3.9223 3.9239 3.9314];

% Gjør 10 målinger av V og VL for 10 ohm
V = [579.89 578.90 578.99 579.40 578.69 578.44 578.50 578.45 578.41 578.05];
Vl = [4.4123 4.4120 4.4123 4.4125 4.4127 4.4130 4.4131 4.4133 4.4135 ...
      4.4139];
R = [10];

% Gjør 10 målinger mellom 1 og 1000 ohm
V1 = [875.75 751.85 634.58 582.84 549.30 527.71 516.49 510.67 507.78 506.09]*1e-3;
Vl1 = [3.8957 4.1403 4.3327 4.4104 4.4575 4.4861 4.5005 4.5076 4.5112 4.5133];
R1 = [1 2 5 10 21 47 100 216 464 1000]; % logspace(0,3,10)

% Gjør 10 målinger i negativ retning
V2 = [-4.8134 -4.6195 -4.4063 -3.1121 -1.1410 -1.0131 -0.92555 -0.41558 0.05522 0.30018 0.43635 0.44920 0.48653 0.49761 0.50186 ...
     0.50395];
Vl2 = [-0.191202 -0.38555 -0.9600 -1.8915 -3.8653 -3.9828 -4.0716 -4.5761 -4.9455 -5.3001 -5.4378 -5.4601 -5.5016 -5.5148 ...
       -5.5200 -5.5225];
R2 = [1 2 5 10 21 21.5 22 25 27 30 40 47 100 216 464 1000]; %
                                                            % logspace(0,3,10)

I1 = Vl1./R1;
I2 = Vl2./R2;
clf
hold on
plot(V1,I, '-o')
plot(V2, I2, '-o')
title('I mot V')
ylabel('I [A]')
xlabel('U [V]')



%%
% Oppgave b
% Gjør 10 målinger ved 10 ohm
V = [490.83 491.25 491.22 491.36 491.25 491.05 491.11 491.14 491.12 491.29 490.98];
Vl = [-488.34 -488.76 -488.74 -488.88 -488.79 -488.59 -488.56 -488.71 -488.66 ...
     -488.77 -488.53];
% Gjør 10 målinger med spenningskilden frakoblet
V3 = [0.10283  0.21869 0.40748 0.47948 0.49659 0.50249 0.50530 ...
     0.50641 0.50690 0.50721];
Vl3 = [-0.093563 -0.21387 -0.26304 -0.33857 -0.37343 -0.40084 -0.40800 -0.41900 ...
        -0.43319 -0.44420 -0.45156 -0.46404 -0.47565 -0.49477 -0.50181 -0.50494 ...
      -0.50624 -0.50892 -0.50901];
R3 = [0.5 1.2 1.5 2 2.3 2.6 2.7 2.9 3.2 3.5 3.8 4.5 6.3 14.7 34.1 79.4 184.7 429.8 1000];

% Frakoblet 
Voc = mean([507.41 507.38 507.34 507.32 507.31 507.32 507.34 507.34 507.36 ...
            507.33])*1e-3
% Gjør 10 målinger av VL ved 0.5 ohm
VIsc = mean([-0.93505 -0.93516 -0.93512 -0.93259 -0.93848 -0.93472 -0.93007 ...
             -0.93106 -0.93244])*1e-1
%Isc = VIsc/0.5
I3 = Vl3./R3;
plot(-Vl3, I3, '-o')
plot(Voc, 0, 'kx')
plot(0, Isc, 'kx')
%%
% Oppgave 2
% 60 grader
V4 = [-60.673 -137.57 -172.23 -229.22 -261.47 -291.25 -299.52 -317.10 -340.55 ...
     -360.5 -377.52 -406.47 -442.19 -475.68 -485.76 -492.21 -492.42]*1e-3;
R4 = [0.5 1.2 1.5 2 2.3 2.6 2.7 2.9 3.2 3.5 3.8 4.5 6.3 14.7 34.1 500 1000];
I4 = -V4./R4;
clf
hold on
plot(-V4, -I4, '-o')
plot(-Vl3, I3, '-o')

% Effekt
P4 = I4.*V4
P3 = I3.*Vl3
clf
hold on
plot(V4,-P4, '-o')
plot(Vl3, P3, '-o')

%%
% Oppgave 3
% Parallell
Voc_begge = -510.28*1e-3
Isc_begge = mean([-183.60 -183.60 -184.57 -184.95 -184.30 -184.62 -184.84 ...
                  -184.88 -184.41 -184.33])*1e-3
% Parallell tildekket
Isc_en = mean([-95.10 -95.22 -95.30 -95.36 -95.27 -95.29 -95.24 -94.97 ...
              -95.17 -95.31])*1e-3
Voc_en = -492.78*1e-3;

% Serie begge
Voc_begge = -1.0230
Isc_begge = mean([-91.441 -91.286 -91.4133 -91.450 -91.573 -91.832 -91.754 ...
                 -91.883 -91.905 -91.868])*1e-3
% Serie tildekket
Voc_en = -529.38*1e-3
Isc_en = -0.520*1e-3

%%
% Oppgave 4
A = 0.0097 % [cm^2] Areal for solcelle
Pmax = 0.0618 % Leser grafen fra oppgave 3
Vs = 0.83*1e-3 % Leser solarimeter
a = 11.83*1e-6 % Kalibreringskonstant
Pinn = Vs*A/a 
eta = Pmax/Pinn*100

% Usikkerhet i lengdemål
dl = 0.1e-2 % [m] 
% Usikkerhet i areal
dA = sqrt(2*(dl/0.1)^2+2*(dl/0.013)^2) % [m^2]
% Usikkerhet i Vs. Spenningen varierte med 0.02 mV
dVs = 0.02e-3 % [V]
% Usikkerhet i Pinn
dPinn = Pinn*sqrt((dVs/Vs)^2+(dA/A)^2)
% Usikkerhet i V
dV = std(V)
% Usikkerhet i Pmax
dPmax = 2*dV/mean(V)*Pmax
% Usikkerhet i eta
dEta = eta * sqrt((dPinn/Pinn)^2+(dPmax/Pmax^2)^2)